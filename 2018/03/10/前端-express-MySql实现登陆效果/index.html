
<!-- 分别定义了不同页面下博客的title显示 -->


<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>CSS+express+MySql实现登陆效果Xiaoqi&#39;s blog</title>
<!--   <link href="https://fonts.googleapis.com/css?family=Gloria+Hallelujah" rel="stylesheet"> -->
  <!-- theme为主题的config.yml -->
  
    <!-- stylesheets list from config.yml -->
    <!-- 即对config.yml下stylesheets下外部样式的引入，但是具体怎么引入？目前还未弄清楚 -->
    
      <link rel="stylesheet" href="/css/Graffiti.css">
    
  
</head>
<body>

<!-- 导航栏 -->
<!-- 导航栏部分 -->
<div id="navigationBar-bg" class="navigationBar-bg" style="background: url('/img/navigationBar.jpg') no-repeat;">
  <div id="navigationBar-content" class="navigationBar-content">
    <div class="personal-block">
      <div class="portrait">
        <div class="portrait-background">
          <div class="portrait-img" style="background: url('/img/portrait.jpg') no-repeat; background-size: 100%"></div>
        </div>
      </div>
      <div class="nickname"><span>Xiaoqi&#39;s blog</span></div>
    </div>

    <div class="navigationBar-menu">
      
        <li>
          <div class="menu-hover Home-hover"></div>
          <a id="Home" href="/">Home</a>
        </li>
      
        <li>
          <div class="menu-hover Archives-hover"></div>
          <a id="Archives" href="/archives">Archives</a>
        </li>
      
        <li>
          <div class="menu-hover Tags-hover"></div>
          <a id="Tags" href="/tags">Tags</a>
        </li>
      
        <li>
          <div class="menu-hover Github-hover"></div>
          <a id="Github" href="https://github.com/Qxiaoqi">Github</a>
        </li>
      
    </div>
  </div>
</div>

<!-- layout渲染部分 -->
<div id="content-outer" class="content-outer">
  <div class="content-margin">
    <div id="content-inner" class="content-inner">
      
<article id="post" class="post">
	<div class="post-title">
  		<span class="post-title-link">CSS+express+MySql实现登陆效果</span>
	</div>
  <!-- <img src="/assets/2018-3-10/before.jpg" height="300px"> -->
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>最近连着整理了好几篇博客，这些都是前一段时间做的东西，希望拿出来整理一下，加深印象。</p>
<p>之前看了一些nodejs，然后希望做出来点东西来实践，然后刚好在掘金上看到一个很棒的登陆效果，于是把他复现的同时也顺手做了个和后端交互的部分，就是注册账号，和登陆账号这么个简单的功能。然后发现express框架真的很好用，nodejs这块就采用了express框架来写，数据库用了Mysql。</p>
<a id="more"></a>
<h2 id="页面展示"><a href="#页面展示" class="headerlink" title="页面展示"></a>页面展示</h2><p>感觉还是有点小炫酷的，登陆页面是一个动态效果，一个方块气泡上升的效果。</p>
<p>登陆界面<br><img src="/assets/2018-3-10/display_1.jpg" height="300px"></p>
<p>注册界面<br><img src="/assets/2018-3-10/display_2.jpg" height="300px"></p>
<h2 id="技术细节"><a href="#技术细节" class="headerlink" title="技术细节"></a>技术细节</h2><h3 id="前端效果部分"><a href="#前端效果部分" class="headerlink" title="前端效果部分"></a>前端效果部分</h3><h4 id="气泡效果"><a href="#气泡效果" class="headerlink" title="气泡效果"></a>气泡效果</h4><p>主要就是一层一层的往上压，使用z-index来控制谁在上面，该效果则是气泡在背景上面。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"bg-bubbles"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>css代码选取部分，其他的可以自己定义<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">ul</span> <span class="selector-tag">li</span> &#123;</span><br><span class="line">	<span class="attribute">position</span>: absolute;</span><br><span class="line">	<span class="attribute">z-index</span>: <span class="number">5</span>;</span><br><span class="line">	<span class="attribute">list-style</span>: none;</span><br><span class="line">	<span class="attribute">position</span>: absolute;</span><br><span class="line">	<span class="attribute">bottom</span>: -<span class="number">160px</span>;</span><br><span class="line">	<span class="attribute">width</span>: <span class="number">40px</span>;</span><br><span class="line">	<span class="attribute">height</span>: <span class="number">40px</span>;</span><br><span class="line">	<span class="attribute">background-color</span>: <span class="built_in">rgba</span>(255, 255, 255, 0.15);</span><br><span class="line">	animation: square 25s infinite;		//依次为动画名称，时间，播放次数（无限）</span><br><span class="line">	transition-timing-function: linear;	//速度曲线（从头到尾相同）</span><br><span class="line">	&amp;<span class="selector-pseudo">:nth-child(1)</span> &#123;</span><br><span class="line">		<span class="attribute">left</span>: <span class="number">10%</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	&amp;<span class="selector-pseudo">:nth-child(2)</span> &#123;</span><br><span class="line">		<span class="attribute">left</span>: <span class="number">20%</span>;</span><br><span class="line">		<span class="attribute">width</span>: <span class="number">90px</span>;</span><br><span class="line">		<span class="attribute">height</span>: <span class="number">90px</span>;</span><br><span class="line">		<span class="attribute">animation-delay</span>: <span class="number">2s</span>;</span><br><span class="line">		<span class="attribute">animation-duration</span>: <span class="number">17s</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	//以上自己定义</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	//动画执行</span><br><span class="line">	@<span class="keyword">keyframes</span> square &#123;</span><br><span class="line">		0% &#123;</span><br><span class="line">			<span class="attribute">transform</span>: <span class="built_in">translateY</span>(-700px);</span><br><span class="line">		&#125;</span><br><span class="line">      	100% &#123;</span><br><span class="line">        	<span class="attribute">transform</span>: <span class="built_in">translateY</span>(-700px) <span class="built_in">rotate</span>(600deg);</span><br><span class="line">      	&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure></p>
<p>上面代码使用less写的，less语法很简单，相比于sass应该来说语法少了很多，可以使用Sublime Text的插件来实现自动编译成css的效果，或者也可以使用webpack，gulp等自动胡工具通过编写任务来实现编译。</p>
<ul>
<li><p>背景使用<code>background-image: linear-gradient( 135deg, #FFF6B7 10%, #F6416C 100%);</code>来分别控制颜色渐变方向，两个颜色</p>
</li>
<li><p>气泡的上升是通过<code>translateY()</code>来控制的</p>
</li>
<li><p>气泡的旋转是通过<code>rotate()</code>来控制的</p>
</li>
<li><p>但是有一处不知道为什么，气泡为什么会在最上面疑似停留一会才消失的效果，倘若是因为<code>transition-timing-function:</code>控制速度曲线的原因的话，那么此处设置的是<code>linear</code>应该是一直平均速度运行，为什么在最后会很慢呢。暂未解决</p>
</li>
</ul>
<h4 id="弹窗效果"><a href="#弹窗效果" class="headerlink" title="弹窗效果"></a>弹窗效果</h4><p>原理很简单，当用户点击注册新账号的时候会调用一个函数，改函数会将一个之前写好的并用display:none隐藏的div块重新改为display:block使之重新显现。同时也可以在之前写好一个大的div并用z-index控制层叠位置来使整个背景遮罩变暗</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">//背景遮罩</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"overlay"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">//注册窗口</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"register-box"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"close-box"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"register-content"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"register-username"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">placeholder</span>=<span class="string">"请输入用户名"</span> <span class="attr">id</span>=<span class="string">"register-username"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"register-password"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">placeholder</span>=<span class="string">"请输入密码"</span> <span class="attr">id</span>=<span class="string">"register-password"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span>  <span class="attr">class</span>=<span class="string">"register-repassword"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">placeholder</span>=<span class="string">"请再次输入密码"</span> <span class="attr">id</span>=<span class="string">"register-repassword"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"register-button"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">button</span>&gt;</span>立即注册<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> showRegister = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">"s"</span>);</span><br><span class="line">	$(<span class="string">".overlay"</span>).css(<span class="string">"display"</span>,<span class="string">"block"</span>);</span><br><span class="line">	$(<span class="string">".register-box"</span>).css(<span class="string">"display"</span>,<span class="string">"block"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> closeRegister = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	$(<span class="string">".overlay"</span>).css(<span class="string">"display"</span>,<span class="string">"none"</span>);</span><br><span class="line">	$(<span class="string">".register-box"</span>).css(<span class="string">"display"</span>,<span class="string">"none"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="express框架部分"><a href="#express框架部分" class="headerlink" title="express框架部分"></a>express框架部分</h3><h4 id="服务器运行"><a href="#服务器运行" class="headerlink" title="服务器运行"></a>服务器运行</h4><p>首先，这一部分要想跑起来的代码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> server = app.listen(<span class="number">8888</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">var</span> host = server.address().address</span><br><span class="line">  <span class="keyword">var</span> port = server.address().port</span><br><span class="line"> </span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"应用实例，访问地址为 http://%s:%s"</span>, host, port)</span><br><span class="line"> </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>端口号为8888，同时输出对应访问地址</p>
<h4 id="设置路由"><a href="#设置路由" class="headerlink" title="设置路由"></a>设置路由</h4><p>然后设置相应路由，即访问不同地址的时候返回给前端的内容不同</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">app.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">	res.sendFile(__dirname + <span class="string">"/public/"</span> + <span class="string">"index.html"</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.post(<span class="string">'/process_login'</span>,<span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line"> </span><br><span class="line">   <span class="built_in">console</span>.log(req.body.username);</span><br><span class="line">   <span class="built_in">console</span>.log(req.body.password);</span><br><span class="line">   <span class="keyword">if</span>(req.body.username === <span class="string">"xiaoqi"</span> &amp;&amp; req.body.password === <span class="string">"1111"</span>) &#123;</span><br><span class="line">       res.end(<span class="built_in">JSON</span>.stringify(dataSuccess));</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">   	   res.end(<span class="built_in">JSON</span>.stringify(dataError));</span><br><span class="line">   &#125;   </span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//调用与数据库交互的方法</span></span><br><span class="line">app.post(<span class="string">'/process_register'</span>,<span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line"> </span><br><span class="line">   <span class="built_in">console</span>.log(req.body.username);</span><br><span class="line">   <span class="built_in">console</span>.log(req.body.password);</span><br><span class="line">   userDao.add(req, res);</span><br><span class="line">     </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li><p>sendFile方法返回一个文件</p>
</li>
<li><p>get方法时要返回数据给前端需要使用req.query来获取URL的查询参数串 </p>
</li>
<li><p>post方法使用req.body获得请求主体 </p>
</li>
<li><p>然后返回给前端的要是JSON格式转成字符串的格式</p>
</li>
<li><p>此处还未使用mysql，所以假定了一个账号和密码方便此时的测试</p>
</li>
</ul>
<h4 id="设置静态文件"><a href="#设置静态文件" class="headerlink" title="设置静态文件"></a>设置静态文件</h4><p>当完成上述部分之后会发现相应的css与js内容并未配置到相应html文件中，在express提供了内置的中间件express.static来设置静态文件，例如将相应的文件都放在public目录下。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.use(express.static(<span class="string">'public'</span>));</span><br></pre></td></tr></table></figure>
<p>使用一行简单的命令即可</p>
<h4 id="json解析"><a href="#json解析" class="headerlink" title="json解析"></a>json解析</h4><p>当运行的时候会发现使用ajax提交的数据无法被解析，那么可以使用express中的一个bodyParser中间件来进行解析，简单的两行代码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 添加json解析</span></span><br><span class="line">app.use(bodyParser.json());</span><br><span class="line">app.use(bodyParser.urlencoded(&#123;<span class="attr">extended</span>: <span class="literal">false</span>&#125;));</span><br></pre></td></tr></table></figure>
<ul>
<li>使用之前要引入<code>var bodyParser = require(&#39;body-parser&#39;);</code></li>
</ul>
<h3 id="登陆逻辑"><a href="#登陆逻辑" class="headerlink" title="登陆逻辑"></a>登陆逻辑</h3><p>这部分比较的没什么新的要整理的，主要就是ajax传值的时候记得用<code>JSON.stringify</code>把json格式转成字符串。</p>
<h3 id="mysql数据库部分"><a href="#mysql数据库部分" class="headerlink" title="mysql数据库部分"></a>mysql数据库部分</h3><p>数据库部分为了使项目看起来更有层次，多添加了两个文件夹，conf用来放配置文件，dao用来放与数据库交互的部分</p>
<h4 id="创建mysql表"><a href="#创建mysql表" class="headerlink" title="创建mysql表"></a>创建mysql表</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> <span class="keyword">NAMES</span> utf8;</span><br><span class="line"><span class="keyword">SET</span> FOREIGN_KEY_CHECKS = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">--  Table structure for `websites`</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> <span class="string">`users`</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`users`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`username`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span> <span class="keyword">COMMENT</span> <span class="string">'用户名'</span>,</span><br><span class="line">  <span class="string">`password`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">--  Records of `websites`</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">BEGIN</span>;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`users`</span> <span class="keyword">VALUES</span> (<span class="string">'1'</span>, <span class="string">'xiaoqi'</span>, <span class="string">'1111'</span>);</span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> FOREIGN_KEY_CHECKS = <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<p>只有三个值，分别是id，username和password非常的简单</p>
<h4 id="conf中数据库配置文件"><a href="#conf中数据库配置文件" class="headerlink" title="conf中数据库配置文件"></a>conf中数据库配置文件</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// conf/db,js</span></span><br><span class="line"><span class="comment">// MySQL数据库连接配置</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">	mysql: &#123;</span><br><span class="line">		host: <span class="string">'localhost'</span>,</span><br><span class="line">		user: <span class="string">'root'</span>,</span><br><span class="line">		password: <span class="string">'1111'</span>,</span><br><span class="line">		port: <span class="string">'3306'</span>,</span><br><span class="line">		database: <span class="string">'login_information'</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="dao中数据库命令编写"><a href="#dao中数据库命令编写" class="headerlink" title="dao中数据库命令编写"></a>dao中数据库命令编写</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> user = &#123;</span><br><span class="line">	insert: <span class="string">'INSERT INTO users(id, username, password) VALUE(0,?,?)'</span>,</span><br><span class="line">	update: <span class="string">'update users set username=?, password=? where id=?'</span>,</span><br><span class="line">	<span class="keyword">delete</span>: <span class="string">'delete form users where id=?'</span>,</span><br><span class="line">	queryById: <span class="string">'select * from users where id=?'</span>,</span><br><span class="line">	queryAll: <span class="string">'select * from users'</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = user;</span><br></pre></td></tr></table></figure>
<h4 id="dao中与数据库交互"><a href="#dao中与数据库交互" class="headerlink" title="dao中与数据库交互"></a>dao中与数据库交互</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//dao/userDao.js</span></span><br><span class="line"><span class="comment">//实现与Mysql交互</span></span><br><span class="line"><span class="keyword">var</span> mysql = <span class="built_in">require</span>(<span class="string">'mysql'</span>);</span><br><span class="line"><span class="keyword">var</span> $conf = <span class="built_in">require</span>(<span class="string">'../conf/db'</span>);</span><br><span class="line"><span class="keyword">var</span> $sql = <span class="built_in">require</span>(<span class="string">'./userSql'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// var connection = mysql.createConnection($conf.mysql);</span></span><br><span class="line"><span class="keyword">var</span> pool = mysql.createPool( $conf.mysql );</span><br><span class="line"><span class="comment">//向前端返回结果</span></span><br><span class="line"><span class="keyword">var</span> jsonWrite = <span class="function"><span class="keyword">function</span>(<span class="params">res, ret</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(<span class="keyword">typeof</span> ret === <span class="string">'undefined'</span>) &#123;</span><br><span class="line">		<span class="built_in">console</span>.log(<span class="string">"ret === undefined"</span>);</span><br><span class="line">		<span class="built_in">console</span>.log(<span class="string">"ret ="</span> + ret);</span><br><span class="line">		res.end(<span class="built_in">JSON</span>.stringify(&#123;</span><br><span class="line">			status: <span class="string">'2'</span>,</span><br><span class="line">			msg: <span class="string">'操作失败'</span></span><br><span class="line">		&#125;));</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="built_in">console</span>.log(<span class="string">"ret !== undefined"</span>);</span><br><span class="line">		<span class="built_in">console</span>.log(ret);</span><br><span class="line">		res.end(<span class="built_in">JSON</span>.stringify(ret));</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">	add: <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">		<span class="built_in">console</span>.log(<span class="string">"add方法运行"</span>);</span><br><span class="line">		pool.getConnection(<span class="function"><span class="keyword">function</span>(<span class="params">err, connection</span>) </span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(err) &#123;</span><br><span class="line">				<span class="comment">// console.log("pool报错");</span></span><br><span class="line">				<span class="keyword">throw</span> err;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">var</span> param = req.body;</span><br><span class="line">			connection.query($sql.insert, [param.username, param.password], <span class="function"><span class="keyword">function</span>(<span class="params">err, result</span>) </span>&#123;</span><br><span class="line">				<span class="keyword">if</span>(result) &#123;</span><br><span class="line">					result = &#123;</span><br><span class="line">						status: <span class="number">200</span>,</span><br><span class="line">						msg: <span class="string">'增加成功'</span></span><br><span class="line">					&#125;;</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				<span class="comment">//以json形式，把操作结果返回给前端</span></span><br><span class="line">				jsonWrite(res, result);</span><br><span class="line"></span><br><span class="line">				<span class="comment">// 释放连接 </span></span><br><span class="line">				connection.release();</span><br><span class="line">			&#125;)</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>数据库这部分代码整合了网上的代码，并加上了我自己的内容，但是对于其中数据库部分的一些原理可能不是很了解，比如说pool连接池</p>
</li>
<li><p>query方法就类似于直接在命令行中敲sql命令</p>
</li>
</ul>
<p>可以在数据库中查询，每当注册新用户之后，确实发现数据库中新增了相应的数据，那么这个项目的核心已经基本完成了。</p>
<h2 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h2><p>整理这篇文章的时候大概已经是做完这个项目一周之后的事情了，法相其中的一些小细节已经忘了，只能整理一些大概的内容，感觉效果并不是非常的好，所以以后在做完项目的时候一定要第一时间整理，才能达到最好的效果。</p>

</article>



    </div>

    <!-- footer部分 -->
    <!-- footer部分 -->
<div id="footer-outer" class="footer-outer">
  <div id="footer-inner" class="footer-inner">
    <span class="footer-left">© Xiaoqi </span>
    <span class="footer-right">Hexo Theme Graffiti by Xiaoqi</span>
  </div>
</div>  
  </div>

</div>



  <!-- scripts list from theme config.yml -->
  
    <script src="/js/jquery-3.2.1.js"></script>
  
    <script src="/js/graffiti.js"></script>
  


</body>
</html>
